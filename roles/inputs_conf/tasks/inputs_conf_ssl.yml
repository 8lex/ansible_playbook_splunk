---
#####################################################################################################################
# Configurations for Splunk inputs.conf
#####################################################################################################################

#####################################################################################################################
# [SSL]
#####################################################################################################################

# rootCA

- name: Set rootCA
  ini_file: dest="{{ splunk_conf_path }}/inputs.conf"
            section=SSL
            option=rootCA 
            value={{ splunk_inputs_conf.SSL.rootCA }}
            state=present
  when: splunk_inputs_conf.SSL.rootCA is defined

- name: Unset rootCA (default)
  ini_file: dest="{{ splunk_conf_path }}/inputs.conf"
            section=SSL 
            option=rootCA
            state=absent
  when: splunk_inputs_conf.SSL.rootCA is undefined


# serverCert

- name: Set serverCert
  ini_file: dest="{{ splunk_conf_path }}/inputs.conf"
            section=SSL 
            option=serverCert
            value={{ splunk_inputs_conf.SSL.serverCert }}
            state=present
  when: splunk_inputs_conf.SSL.rootCA is defined

- name: Unset serverCert (default)
  ini_file: dest="{{ splunk_conf_path }}/inputs.conf"
            section=SSL 
            option=serverCert
            state=absent
  when: splunk_inputs_conf.SSL.serverCert is undefined

# password

- name: Set password
  ini_file: dest="{{ splunk_conf_path }}/inputs.conf"
            section=SSL
            option=password
            value={{ splunk_inputs_conf.SSL.password }}
            state=present
  when: splunk_inputs_conf.SSL.password is defined

- name: Unset password (default)
  ini_file: dest="{{ splunk_conf_path }}/inputs.conf"
            section=SSL
            option=password
            state=absent
  when: splunk_inputs_conf.SSL.password is undefined
